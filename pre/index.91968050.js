const COUPON_CODES_ACTIVE=!0;async function getCouponCodesDB(){const e=TEST_ENVIRONMENT?"test_coupon_codes":"coupon_codes",o="magazine",t=await db.collection(e).doc(o);let n=[],s=!1,r=await t.get(),a=r.exists?r.data():"document data does not exist";return s=a.active,s?n=a.codes:console.log("magazine coupon codes are not active"),n}function getUserEnteredCouponCode(){const e=document.getElementById("ibat-coupon-code");e||console.error("dev:coupon input field doesn't exist");let o=e.value;return o=o.toString().toLowerCase(),o}async function isValidCouponCode(e="",o=[]){""===e&&(e=getUserEnteredCouponCode()),0===o.length&&(o=await getCouponCodesDB());let t=!1;return!e||e.length<5?(console.error("dev: coupon code entered is invalid"),t):(o.includes(e)?t=!0:console.error("dev: coupon code entered is not present in DB"),t)}async function updateCouponUserDB(e,o,t,n){try{const s=TEST_ENVIRONMENT?"test_coupon_users":"coupon_users",r="magazine",a=await db.collection(`/${s}/${r}/transactions`),c=new Date,[d,i,u]=[c.getMonth(),c.getDate(),c.getFullYear()],[l,p,g]=[c.getHours(),c.getMinutes(),c.getSeconds()],C=`${i}-${d}-${u}`,m={transactionID:e,userAddress:o,bnbAmount:t,ibatAmount:n,userDate:C,userTime:`${l}-${p}-${g}`,userTimestamp:c,serverTimestamp:firebase.firestore.FieldValue.serverTimestamp()};a.add(m)}catch(e){console.error(e),console.error("dev:updateCouponUserDB() failed")}}
//# sourceMappingURL=index.91968050.js.map
