const COUPON_CODES_ACTIVE=!0;async function getCouponCodesDB(){const e=TEST_ENVIRONMENT?"test_coupon_codes":"coupon_codes",o="magazine",t=await db.collection(e).doc(o);let n=[],s=!1,r=await t.get(),c=r.exists?r.data():"document data does not exist";return s=c.active,s?n=c.codes:console.log("magazine coupon codes are not active"),n}function getUserEnteredCouponCode(){const e=document.getElementById("ibat-coupon-code");e||console.error("dev:coupon input field doesn't exist");let o=e.value;return o=o.toString().toLowerCase(),o}async function isValidCouponCode(e="",o=[]){""===e&&(e=getUserEnteredCouponCode()),0===o.length&&(o=await getCouponCodesDB());let t=!1;return!e||e.length<5?(console.error("dev: coupon code entered is invalid"),t):(o.includes(e)?t=!0:console.error("dev: coupon code entered is not present in DB"),t)}async function updateCouponUserDB(e,o,t,n,s){try{const r=TEST_ENVIRONMENT?"test_coupon_users":"coupon_users",c="magazine",a=await db.collection(`/${r}/${c}/transactions`),d=new Date,[u,i,l]=[d.getMonth(),d.getDate(),d.getFullYear()],[p,g,C]=[d.getHours(),d.getMinutes(),d.getSeconds()],m=`${i}-${u}-${l}`,E={transactionID:e,userAddress:o,bnbAmount:t,ibatAmount:n,coupon:s,userDate:m,userTime:`${p}-${g}-${C}`,userTimestamp:d,serverTimestamp:firebase.firestore.FieldValue.serverTimestamp()};a.add(E)}catch(e){console.error(e),console.error("dev:updateCouponUserDB() failed")}}
//# sourceMappingURL=index.bee4fc88.js.map
